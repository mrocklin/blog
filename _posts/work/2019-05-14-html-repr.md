---
layout: post
title: HTML outputs in Jupyter, and thoughts on visual design
tagline: Learn CSS, for Science
author: Matthew Rocklin
draft: true
tags: [python,scipy]
theme: twitter
---
{% include JB/setup %}

I think that software projects should focus more more on visual user experience.
I think that today this has a greater impact than numerical performance or API design
(relative to how much we currently talk about either).

The Scientific Python stack in particular has historically focused on
performance and API design far more than visual UX, and I think that we should
reverse that trend for a while.


HTML outputs in Jupyter
-----------------------

First, I want to highlight a few positive examples I've seen recently,
specifically around using Jupyter's ability to add HTML output for any object.


### Iris

Here is how the UK Met Office library Iris, prints itself to a notebook (work
by [Peter Killick](https://github.com/DPeterK)):

<img src="https://user-images.githubusercontent.com/3473068/39761846-0da53302-52d1-11e8-9f95-94877801ee78.png"
     width="100%">

### Dask Kubernetes

And an expandable logs widget for all of the workers in a Dask-Kubernetes
cluster by [Jacob Tomlinson](https://github.com/jacobtomlinson).

<img
src="https://user-images.githubusercontent.com/1610850/56971497-44190180-6b61-11e9-85e9-0c3d9279f8f1.png"
width="100%">

The code for these is simple.  Here's the implementation for the logs widget

```python
class Log(str):
    """A container for logs."""

     def _widget(self):
        from ipywidgets import HTML
        return HTML(
            value="<pre><code>{logs}</code></pre>".format(logs=self)
        )

     def _ipython_display_(self, **kwargs):
        return self._widget()._ipython_display_(**kwargs)


 class Logs(dict):
    """A container for multiple logs."""

     def _widget(self):
        from ipywidgets import Accordion
        accordion = Accordion(children=[log._widget() for log in self.values()])
        [accordion.set_title(i, title) for i, title in enumerate(self.keys())]
        return accordion

     def _ipython_display_(self, **kwargs):
        return self._widget()._ipython_display_(**kwargs)
```

### Xarray


Here is another in a PR for Xarray.  It's all about optionally exposing
information, so I encourage you to play with it over at
[nbviewer](https://nbviewer.jupyter.org/gist/benbovy/3009f342fb283bd0288125a1f7883ef2).


### Dask Array

Inspired by these I took a look at how we render Dask Arrays to the screen

```python
In [1]: import dask.array as da

In [2]: da.ones((10, 1024, 1024), chunks=(1, 256, 256))
Out[2]: dask.array<ones, shape=(10, 1024, 1024), dtype=float64, chunksize=(1, 256, 256)>
```

Which, while compact, could be improved.  I spent a day and made this.

<img src="https://user-images.githubusercontent.com/306380/57591783-b6da9300-74f8-11e9-9152-a1fe86dcf51c.png"
     width="80%">

[dask/dask #4794](https://github.com/dask/dask/pull/4794)

It was designed around common problems I've had in trying to convey information
about chunking to new users of the library (this commonly translates into
performance problems for novices).  I found myself relying on it for chunking
information almost immediately.  I think it will do a lot of good, it looks
nice, and was easy to implement.

We should do more of this.
